const addStyles=()=>{const n=document.createElement("style");n.textContent="\n    .item-content {\n      margin: 5px 0 10px 0;\n    }\n    #welcome-info {\n      user-select: none;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      height: 212px;\n      padding: 10px;\n      border-radius: 8px;\n      background-color: var(--anzhiyu-background);\n      outline: 1px solid var(--anzhiyu-card-border);\n    }\n    .loading-spinner {\n      width: 50px;\n      height: 50px;\n      border: 3px solid rgba(0, 0, 0, 0.1);\n      border-radius: 50%;\n      border-top: 3px solid var(--anzhiyu-main);\n      animation: spin 1s linear infinite;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    .ip-address {\n      filter: blur(5px);\n      transition: filter 0.3s ease;\n    }\n    .ip-address:hover {\n      filter: blur(0);\n    }\n    .error-message {\n      color: #ff6565;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n    }\n    .error-message p,\n    .permission-dialog p {\n      margin: 0;\n    }\n    .error-icon {\n      font-size: 3rem;\n    }\n    #retry-button {\n      margin: 0 5px;\n      color: var(--anzhiyu-main);\n      transition: transform 0.3s ease;\n    }\n    #retry-button:hover {\n      transform: rotate(180deg);\n    }\n    .permission-dialog {\n      text-align: center;\n    }\n    .permission-dialog button {\n      margin: 10px 5px;\n      padding: 5px 10px;\n      border: none;\n      border-radius: 5px;\n      background-color: var(--anzhiyu-main);\n      color: white;\n      transition: opacity 0.3s ease;\n    }\n    .permission-dialog button:hover {\n      opacity: 0.8;\n    }\n  ",document.head.appendChild(n)},createAnnouncementComponent=()=>{const n=document.createElement("div");return n.classList.add("card-widget","card-ip-info"),n.innerHTML='\n    <div class="item-headline">\n      <i class="fa-solid fa-user-large" style="font-size: 18px;color: red;"></i>\n      <span>æ¬¢è¿æ¥è®¿è€…ï¼</span>\n    </div>\n    <div class="item-content">\n      ğŸ‘‹ğŸ» Hiï¼Œæˆ‘æ˜¯èƒœå¤©åŠå­ï¼Œæ¬¢è¿ä½ ï¼<br>\n      â“ å¦‚æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºåŒºäº¤æµï¼<br>\n      ğŸ˜« é¡µé¢å¼‚å¸¸ï¼Ÿå°è¯•<kbd>Ctrl</kbd>+<kbd>F5</kbd><br>\n      ğŸ“§ å¦‚éœ€è”ç³»æˆ‘ï¼š<a href="mailto:ruoms@qq.com"><b>å‘é€é‚®ä»¶ğŸš€</b></a>\n    </div>\n    <div id="welcome-info">\n      <div class="loading-spinner"></div>\n    </div>\n  ',n},insertAnnouncementComponent=()=>{if(!isHomePage())return;const n=document.querySelector(".card-widget.card-info");if(n){const e=document.querySelector(".card-widget.card-ip-info");e?.remove(),n.parentNode.insertBefore(createAnnouncementComponent(),n.nextSibling)}},checkLocationPermission=()=>"granted"===localStorage.getItem("locationPermission"),saveLocationPermission=n=>{localStorage.setItem("locationPermission",n)},showLocationPermissionDialog=()=>{document.getElementById("welcome-info").innerHTML='\n    <div class="permission-dialog">\n      <div class="error-icon">â“</div>\n      <p>æ˜¯å¦å…è®¸è®¿é—®æ‚¨çš„ä½ç½®ä¿¡æ¯ï¼Ÿ</p>\n      <button id="allow-location">å…è®¸</button>\n      <button id="deny-location">æ‹’ç»</button>\n    </div>\n  ';const n=n=>{saveLocationPermission(n),"granted"===n?(showLoadingSpinner(),fetchIpInfo()):showErrorMessage("æ‚¨å·²æ‹’ç»è®¿é—®ä½ç½®ä¿¡æ¯")};document.getElementById("allow-location").addEventListener("click",(()=>n("granted"))),document.getElementById("deny-location").addEventListener("click",(()=>n("denied")))},showLoadingSpinner=()=>{document.getElementById("welcome-info").innerHTML='<div class="loading-spinner"></div>'},fetchIpInfo=async()=>{if(checkLocationPermission()){showLoadingSpinner();try{const n=await fetch("https://api.76.al/api/ip/query?key=nReEyBliaeyvx29CX2SG4Zgd38");if(!n.ok)throw new Error("ç½‘ç»œå“åº”ä¸æ­£å¸¸");const e=await n.json();showWelcome(e)}catch(n){console.error("é”™è¯¯:",n),showErrorMessage()}}else showLocationPermissionDialog()},getDistance=(n,e,t,i)=>{const o=n=>n*Math.PI/180,[r,a]=[e,i].map(o),[s,d]=[i-e,t-n].map(o),c=Math.sin(s/2)**2+Math.cos(r)*Math.cos(a)*Math.sin(d/2)**2,l=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return Math.round(6371*l)},greetings={"ä¸­å›½":{"åŒ—äº¬å¸‚":"åŒ—â€”â€”äº¬â€”â€”æ¬¢è¿ä½ ~~~","å¤©æ´¥å¸‚":"è®²æ®µç›¸å£°å§","æ²³åŒ—çœ":"å±±åŠ¿å·å·æˆå£å’ï¼Œå¤©ä¸‹é›„å…³é“é©¬é‡‘æˆˆç”±æ­¤å‘ï¼Œæ— é™æ±Ÿå±±","å±±è¥¿çœ":"å±•å¼€åå…·é•¿ä¸‰å°ºï¼Œå·²å å±±æ²³äº”ç™¾ä½™","å†…è’™å¤è‡ªæ²»åŒº":"å¤©è‹è‹ï¼Œé‡èŒ«èŒ«ï¼Œé£å¹è‰ä½è§ç‰›ç¾Š","è¾½å®çœ":"æˆ‘æƒ³åƒçƒ¤é¸¡æ¶ï¼","å‰æ—çœ":"çŠ¶å…ƒé˜å°±æ˜¯ä¸œåŒ—çƒ§çƒ¤ä¹‹ç‹","é»‘é¾™æ±Ÿçœ":"å¾ˆå–œæ¬¢å“ˆå°”æ»¨å¤§å‰§é™¢","ä¸Šæµ·å¸‚":"ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸­å›½åªæœ‰ä¸¤ä¸ªåŸå¸‚","æ±Ÿè‹çœ":{"å—äº¬å¸‚":"è¿™æ˜¯æˆ‘æŒºæƒ³å»çš„åŸå¸‚å•¦","è‹å·å¸‚":"ä¸Šæœ‰å¤©å ‚ï¼Œä¸‹æœ‰è‹æ­",default:"æ•£è£…æ˜¯å¿…é¡»è¦æ•£è£…çš„"},"æµ™æ±Ÿçœ":{"æ­å·å¸‚":"ä¸œé£æ¸ç»¿è¥¿æ¹–æŸ³ï¼Œé›å·²è¿˜äººæœªå—å½’",default:"æœ›æµ·æ¥¼æ˜ç…§æ›™éœ,æŠ¤æ±Ÿå ¤ç™½è¹‹æ™´æ²™"},"æ²³å—çœ":{"éƒ‘å·å¸‚":"è±«å·ä¹‹åŸŸï¼Œå¤©åœ°ä¹‹ä¸­","ä¿¡é˜³å¸‚":"å“ä¿¡é˜³æ¯›å°–ï¼Œæ‚Ÿäººé—´èŠ³å","å—é˜³å¸‚":"è‡£æœ¬å¸ƒè¡£ï¼Œèº¬è€•äºå—é˜³æ­¤å—é˜³éå½¼å—é˜³ï¼","é©»é©¬åº—å¸‚":"å³°å³°æœ‰å¥‡çŸ³ï¼ŒçŸ³çŸ³æŒŸä»™æ°”åµ–å²ˆå±±çš„èŠ±å¾ˆç¾å“¦ï¼","å¼€å°å¸‚":"åˆšæ­£ä¸é˜¿åŒ…é’å¤©","æ´›é˜³å¸‚":"æ´›é˜³ç‰¡ä¸¹ç”²å¤©ä¸‹",default:"å¯å¦å¸¦æˆ‘å“å°æ²³å—çƒ©é¢å•¦ï¼Ÿ"},"å®‰å¾½çœ":"èšŒåŸ ä½äº†ï¼ŒèŠœæ¹–èµ·é£","ç¦å»ºçœ":"äº•é‚‘ç™½äº‘é—´ï¼Œå²©åŸè¿œå¸¦å±±","æ±Ÿè¥¿çœ":"è½éœä¸å­¤é¹œé½é£ï¼Œç§‹æ°´å…±é•¿å¤©ä¸€è‰²","å±±ä¸œçœ":"é¥æœ›é½å·ä¹ç‚¹çƒŸï¼Œä¸€æ³“æµ·æ°´æ¯ä¸­æ³»","æ¹–åŒ—çœ":{"é»„å†ˆå¸‚":"çº¢å®‰å°†å†›å¿ï¼è¾ˆå‡ºå°†æ‰ï¼",default:"æ¥ç¢—çƒ­å¹²é¢~"},"æ¹–å—çœ":"74751ï¼Œé•¿æ²™æ–¯å¡”å…‹","å¹¿ä¸œçœ":{"å¹¿å·å¸‚":"çœ‹å°è›®è…°ï¼Œå–æ—©èŒ¶äº†å˜›~","æ·±åœ³å¸‚":"ä»Šå¤©ä½ é€›å•†åœºäº†å˜›~","é˜³æ±Ÿå¸‚":"é˜³æ˜¥åˆæ°´ï¼åšä¸»å®¶ä¹¡~ æ¬¢è¿æ¥ç©~",default:"æ¥ä¸¤æ–¤ç¦å»ºäºº~"},"å¹¿è¥¿å£®æ—è‡ªæ²»åŒº":"æ¡‚æ—å±±æ°´ç”²å¤©ä¸‹","æµ·å—çœ":"æœè§‚æ—¥å‡ºé€ç™½æµªï¼Œå¤•çœ‹äº‘èµ·æ”¶éœå…‰","å››å·çœ":"åº·åº·å·å¦¹å­","è´µå·çœ":"èŒ…å°ï¼Œå­¦ç”Ÿï¼Œå†å¡200","äº‘å—çœ":"ç‰é¾™é£èˆäº‘ç¼ ç»•ï¼Œä¸‡ä»å†°å·ç›´è€¸å¤©","è¥¿è—è‡ªæ²»åŒº":"èººåœ¨èŒ«èŒ«è‰åŸä¸Šï¼Œä»°æœ›è“å¤©","é™•è¥¿çœ":"æ¥ä»½è‡Šå­é¢åŠ é¦","ç”˜è‚ƒçœ":"ç¾Œç¬›ä½•é¡»æ€¨æ¨æŸ³ï¼Œæ˜¥é£ä¸åº¦ç‰é—¨å…³","é’æµ·çœ":"ç‰›è‚‰å¹²å’Œè€é…¸å¥¶éƒ½å¥½å¥½åƒ","å®å¤å›æ—è‡ªæ²»åŒº":"å¤§æ¼ å­¤çƒŸç›´ï¼Œé•¿æ²³è½æ—¥åœ†","æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº":"é©¼é“ƒå¤é“ä¸ç»¸è·¯ï¼Œèƒ¡é©¬çŠ¹é—»å”æ±‰é£","å°æ¹¾çœ":"æˆ‘åœ¨è¿™å¤´ï¼Œå¤§é™†åœ¨é‚£å¤´","é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº":"æ°¸å®šè´¼æœ‰æ®‹ç•™åœ°é¬¼åšï¼Œè¿å‡»å…‰éå²ç‰","æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒº":"æ€§æ„Ÿè·å®˜ï¼Œåœ¨çº¿å‘ç‰Œ",default:"å¸¦æˆ‘å»ä½ çš„åŸå¸‚é€›é€›å§ï¼"},"ç¾å›½":"Let us live in peace!","æ—¥æœ¬":"ã‚ˆã‚ã—ãã€ä¸€ç·’ã«æ¡œã‚’è¦‹ã¾ã›ã‚“ã‹","ä¿„ç½—æ–¯":"å¹²äº†è¿™ç“¶ä¼ç‰¹åŠ ï¼","æ³•å›½":"C'est La Vie","å¾·å›½":"Die Zeit verging im Fluge.","æ¾³å¤§åˆ©äºš":"ä¸€èµ·å»å¤§å ¡ç¤å§ï¼","åŠ æ‹¿å¤§":"æ‹¾èµ·ä¸€ç‰‡æ«å¶èµ äºˆä½ ",default:"å¸¦æˆ‘å»ä½ çš„å›½å®¶é€›é€›å§"},getGreeting=(n,e,t)=>{const i=greetings[n]||greetings.default;if("string"==typeof i)return i;const o=i[e]||i.default;return"string"==typeof o?o:o[t]||o.default},getTimeGreeting=()=>{const n=(new Date).getHours();return n<11?"æ—©ä¸Šå¥½ğŸŒ¤ï¸ ï¼Œä¸€æ—¥ä¹‹è®¡åœ¨äºæ™¨":n<13?"ä¸­åˆå¥½â˜€ï¸ ï¼Œè®°å¾—åˆä¼‘å–”~":n<17?"ä¸‹åˆå¥½ğŸ• ï¼Œé¥®èŒ¶å…ˆå•¦ï¼":n<19?"å³å°†ä¸‹ç­ğŸš¶â€â™‚ï¸ï¼Œè®°å¾—æŒ‰æ—¶åƒé¥­~":"æ™šä¸Šå¥½ğŸŒ™ ï¼Œå¤œç”Ÿæ´»å—¨èµ·æ¥ï¼"},showWelcome=({data:n,ip:e})=>{if(!n)return showErrorMessage();const{lng:t,lat:i,country:o,prov:r,city:a,district:s}=n,d=getDistance(121.524012,38.882522,t,i),c=e.includes(":")?"<br>å¥½å¤æ‚ï¼Œå’±çœ‹ä¸æ‡‚~(ipv6)":e,l="ä¸­å›½"===o?`${r} ${a} ${s}`:o,m=getGreeting(o,r,a),g=getTimeGreeting(),p=document.getElementById("welcome-info");p.style.display="block",p.style.height="auto",p.innerHTML=`\n    æ¬¢è¿æ¥è‡ª <b>${l}</b> çš„å°å‹ğŸ’–<br>\n    å½“å‰ä½ç½®è·åšä¸»çº¦ <b>${d}</b> å…¬é‡Œï¼<br>\n    ä½ çš„IPåœ°å€ï¼š<b class="ip-address">${c}</b><br>\n    ${g}<br>\n    <b>TipsğŸ˜‹ï¼š${m}ğŸ‚</b>\n    <div id="time-spent"><b>å‹æƒ…æç¤ºğŸ¥³ï¼š</b>æ‚¨å·²ç»æµè§ˆè¯¥ç½‘é¡µ <timing></timing></div>\x3c!-- åŠ å…¥å‹æƒ…æç¤º --\x3e</br>  `,startTimer()},showErrorMessage=(n="æŠ±æ­‰ï¼Œæ— æ³•è·å–ä¿¡æ¯")=>{document.getElementById("welcome-info").innerHTML=`\n    <div class="error-message">\n      <div class="error-icon">ğŸ˜•</div>\n      <p>${n}</p>\n      <p>è¯·<i id="retry-button" class="fa-solid fa-arrows-rotate"></i>é‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥</p>\n    </div>\n  `,document.getElementById("retry-button").addEventListener("click",fetchIpInfo)},handlePjaxComplete=()=>{insertAnnouncementComponent(),isHomePage()&&fetchIpInfo()},isHomePage=()=>"/"===window.location.pathname||"/index.html"===window.location.pathname,initialize=()=>{addStyles(),insertAnnouncementComponent(),isHomePage()&&fetchIpInfo(),document.addEventListener("pjax:complete",handlePjaxComplete)};window.onload=initialize;const startTimer=()=>{const n=document.getElementsByTagName("timing")[0];let e=localStorage.getItem("startTime"),t=parseInt(localStorage.getItem("elapsedTime")||"0");const i=(new Date).getTime();function o(n){return n>=0&&n<10?"0"+n:""+n}e?(t+=i-e,localStorage.setItem("elapsedTime",t)):(e=i,localStorage.setItem("startTime",e)),setInterval((function(){const i=t+((new Date).getTime()-e);let r=Math.floor(i/1e3),a=Math.floor(r/3600);r%=3600;let s=Math.floor(r/60);r%=60;const d=o(a)+'<span class="time">å°æ—¶</span>'+o(s)+'<span class="time">åˆ†é’Ÿ</span>'+o(r)+'<span class="time">ç§’</span>';n.innerHTML=d}),1e3)};